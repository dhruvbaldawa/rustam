# Task 1.7: Cloudflare Pages Deployment

## Goal

Deploy the app to Cloudflare Pages so it's accessible from any device at a real URL.

## Working Result

- App is live at a Cloudflare Pages URL (e.g., `rustam.pages.dev`)
- QR codes point to production URL
- Works on mobile browsers
- Can be used at an actual party

## Constraints

- Manual CLI deploy (no CI/CD for now)
- Use existing Cloudflare account

## Dependencies

- All previous tasks (working app locally)

<guidance>

## Build the App

```bash
pnpm build
```

This creates a `dist/` folder with static files.

## Deploy with Wrangler

Install Wrangler (Cloudflare CLI):

```bash
pnpm add -D wrangler
```

First-time setup:

```bash
npx wrangler pages project create rustam
```

Deploy:

```bash
npx wrangler pages deploy dist
```

This uploads to Cloudflare Pages and gives you a URL like `rustam.pages.dev` or a preview URL.

## Update QR Code URL

After deployment, update the app to use the production URL in QR codes:

```javascript
const BASE_URL = import.meta.env.PROD
  ? 'https://rustam.pages.dev'
  : 'http://localhost:5173';
```

Or use `window.location.origin` to auto-detect.

## Environment Variables

Firebase config should already be in the build (via Vite's env handling). Verify the production build works with Firebase.

## Custom Domain (Optional)

If you want a custom domain, configure in Cloudflare Pages dashboard after initial deploy works.

</guidance>

## Validation Checklist

- [ ] `pnpm build` completes without errors
- [ ] Wrangler installed and authenticated
- [ ] `wrangler pages deploy dist` succeeds
- [ ] App accessible at Cloudflare Pages URL
- [ ] QR code points to production URL
- [ ] Can create room from one phone
- [ ] Can join room from another phone (via QR or code)
- [ ] Full game loop works on deployed version
- [ ] Firebase auth and database work in production